# Трансферное обучение нейронных сетей с PyTorch

Трансферное обучение -  метод повторного обучения DNN модели на новом наборе данных, который занимает меньше времени, чем обучение сети с нуля. При трансферном обучении веса предварительно обученной модели настраиваются для классификации нужного набора данных. В этих примерах мы будем использовать сети `ResNet-18` и `SSD-Mobilenet`, но для этого могут подойти и другие сети

<img src="https://github.com/mook003/Triados/blob/main/docs/images/pytorch-resnet-18.png" width="100%">

Обычно обучение нейронных сетей происходит на серверах или производительных ПК из-за часто используемых больших наборов данных и связанных с этим высоких вычислительных требований. Трансферное обучение позволяет переобучить различные сети на не очень производительных устройствах, напрмиер, Nvidia Jetson

PyTorch - программная платформа машинного обучения с открытым исходным кодом. Именно она будет испльзоваться для переобучения сетей

## Установка PyTorch

Для начала установите `PyTorch`

```bash
cd jetson-inference/build
./install-pytorch.sh
```

### Оптимизация системы

Теперь Вы должны установить 4 ГБ места для подкачки, так как обучение может потреблять много дополнительной памяти:

```bash
sudo systemctl disable nvzramconfig
sudo fallocate -l 4G /mnt/4GB.swap
sudo mkswap /mnt/4GB.swap
sudo swapon /mnt/4GB.swap
```

Сделайте введённые изменения постоянными:

```bash
/mnt/4GB.swap  none  swap  sw 0  0
```

### Отключение графического интерфейса рабочего стола

Если во время обучения у вас заканчивается память, вы можете попробовать отключить графический интерфейс рабочего стола Ubuntu во время обучения. Это освободит дополнительную память, которую использует оконный менеджер и рабочий стол.

```bash
sudo init 3     #остановите рабочий стол
# войдите в систему под своим именем пользователя
# запустите код обучения PyTorch
sudo init 5     # перезапустите рабочий стол после работы
```

Если Вы хотите, чтобы рабочий стол был отключен постоянно, нужно ввести одну из следующих команд:

```bash
sudo systemctl set-default multi-user.target     # отключить рабочий стол при запуске
sudo systemctl set-default graphical.target      # включить рабочий стол при запуске
```

Теперь Вы можеет приступить к переобучению сетей.

<p align="right">Дальше | <b><a href="classification_datasets.md">Сбор собственных наборов данных для классификации изображений</a></b>
<br/>
Назад | <b><a href="jetson-inference&ros.md">Jetson-inference и ROS</a></b></p>
<p align="center"><sup>2021-2022 TRIADOS | </sup><a href="../README.md#содержание"><sup>Содержание</sup></a></p>
